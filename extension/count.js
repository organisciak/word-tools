// Generated by CoffeeScript 1.4.0
(function() {
  var getWordCount, simpleTokenizer;

  getWordCount = function(e, t, tokenizer) {
    var _this = this;
    if (tokenizer == null) {
      tokenizer = simpleTokenizer;
    }
    chrome.tabs.executeScript(t.id, {
      code: 'chrome.extension.sendMessage({ loaded: document.getElementById(\'word-count-porganized\')!==null });'
    });
    chrome.extension.onMessage.addListener(function(req, sender, sendResponse) {
      var msg, text, words;
      text = e.selectionText;
      words = tokenizer(text);
      msg = "" + (text.length === 0 ? 'No' : words) + " word" + (words !== 1 ? 's' : '') + " selected";
      if (req.loaded === false) {
        chrome.tabs.executeScript(t.id, {
          file: "dialog.js"
        }, function() {
          return chrome.tabs.sendMessage(t.id, {
            message: msg
          });
        });
      } else {
        chrome.tabs.sendMessage(t.id, {
          message: msg
        });
      }
    });
  };

  simpleTokenizer = function(text) {
    return text.split(" ").length;
  };

  chrome.contextMenus.create({
    "title": "Word Count",
    "contexts": ["selection"],
    "onclick": getWordCount
  });

}).call(this);
